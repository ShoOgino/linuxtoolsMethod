	@Test
	public void testPreferencesPage() throws Exception {
		SWTWorkbenchBot bot = new SWTWorkbenchBot();

		// Set default tool for "timing" profiling.
		checkDefaultPreference(PROFILING_PREFS_CATEGORY, PROFILING_PREFS_TYPE);

		// Open preferences shell.
		SWTBotMenu windowsMenu = bot.menu("Window");
		windowsMenu.menu("Preferences").click();
		SWTBotShell shell = bot.shell("Preferences");
		shell.activate();

		// Go to "Profiling Categories" preferences page.
		SWTBotTreeItem treeItem = bot.tree().expandNode("C/C++").expandNode("Profiling Categories");
		assertNotNull(treeItem);

		// Select "Timing" category page.
		treeItem.select(PROFILING_PREFS_CATEGORY);

		// Get name of default tool to deselect.
		String defaultToolId = ProviderFramework.getProviderIdToRun(null, PROFILING_PREFS_TYPE);
		String defaultToolName = ProviderFramework.getToolInformationFromId(defaultToolId , "name");

		// Workaround for BZ #344484.
		deselectSelectionByName(defaultToolName, bot);

		// Assert specified tool to select is what we expect and select it.
		SWTBotRadio stubRadio = bot.radio(STUB_LABEL);
		assertNotNull(stubRadio);
		assertTrue(STUB_TOOLTIP.equals(stubRadio.getToolTipText()));
		stubRadio.click();

		bot.button("Apply").click();
		bot.button("OK").click();
	}


    /**
     * Writes the current selection to the dialog settings.
     * 
     * @since 3.0
     */
    private void writeSelection() {
        if (fTarget == null)
            return;
        String selection = fTarget.getSelectionText(index);
        if (selection == null)
            selection = ""; //$NON-NLS-1$

        IDialogSettings s = getDialogSettings();
        s.put("selection", selection); //$NON-NLS-1$
    }


    /**
     * Ask the user for the path to save the file at, and check if this path overwrites any existing file.
     * (Note that using dialog.setOverwrite(true) is insufficient, as the path name may be appended with a
     * file extension after the standard overwrite checks occur.)
     * @return A file with the specified pathname, appended with an appropriate extension.
     */
    private File askForAndPrepareFile() {
        final Shell shell = PlatformUI.getWorkbench().getActiveWorkbenchWindow().getShell();
        final FileDialog dialog = new FileDialog(shell, SWT.SAVE);
        dialog.setFilterExtensions(EXTENSIONS);
        dialog.setText(Messages.ChartConstants_SAVE_CHART_DIALOG_TEXT);
        dialog.setFileName(title);

        do {
            String path = dialog.open();
            if (path == null) {
                return null; // Cancelled
            }

            path = makePathWithVerifiedExt(path);

            File file = new File(path);
            if (shouldOverwrite(file, shell)) {
                return file;
            }
            // If not overwriting, bring up dialog again (loop)
            dialog.setFileName(file.getName());
        } while (true);
    }


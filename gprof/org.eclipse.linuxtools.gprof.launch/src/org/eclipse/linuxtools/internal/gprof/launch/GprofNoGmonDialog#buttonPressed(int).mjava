    @Override
    protected void buttonPressed(int buttonId) {
        if (buttonId == 1) {
            FileDialog dialog = new FileDialog(this.getShell(), SWT.OPEN);
            dialog.setText(GprofLaunchMessages.GprofNoGmonDialog_OpenGmon);
            if (project != null) {
                dialog.setFilterPath(project.getLocation().toOSString());
            }
            String s = dialog.open();
            if (s != null) {
                gmonPath = s;
            }
        } else if (buttonId == 2) {
            ElementTreeSelectionDialog dialog = new ElementTreeSelectionDialog(getShell(), new WorkbenchLabelProvider(),
                    new WorkbenchContentProvider());
            dialog.setTitle(GprofLaunchMessages.GprofNoGmonDialog_OpenGmon);
            dialog.setMessage(GprofLaunchMessages.GprofNoGmonDialog_OpenGmon);
            dialog.setInput(ResourcesPlugin.getWorkspace().getRoot());
            dialog.setComparator(new ResourceComparator(ResourceComparator.NAME));
            dialog.setAllowMultiple(false);
            dialog.setInitialSelection(project);
            dialog.setValidator(new ISelectionStatusValidator() {
                @Override
                public IStatus validate(Object[] selection) {
                    if (selection.length != 1) {
                        return new Status(IStatus.ERROR, GprofLaunch.PLUGIN_ID, 0, "", null); //$NON-NLS-1$
                    }
                    if (!(selection[0] instanceof IFile)) {
                        return new Status(IStatus.ERROR, GprofLaunch.PLUGIN_ID, 0, "", null); //$NON-NLS-1$
                    }
                    return new Status(IStatus.OK, GprofLaunch.PLUGIN_ID, 0, "", null); //$NON-NLS-1$
                }
            });
            if (dialog.open() == IDialogConstants.OK_ID) {
                IResource resource = (IResource) dialog.getFirstResult();
                gmonPath = resource.getLocation().toOSString();
            }
        }

        if (gmonPath == null) {
            setReturnCode(0);
        } else {
            setReturnCode(buttonId);
        }
        close();
    }


	/**
	 * Returns <code>true</code> if <code>annotation</code> is visible in
	 * the text viewer (highlighted or decorated).
	 * 
	 * @param annotation the annotation to check the visibility of
	 * @return <code>true</code> if <code>annotation</code> is visible in
	 *         the text viewer, <code>false</code> otherwise
	 */
	protected final boolean isVisibleInText(Annotation annotation) {
		AnnotationPreference preference= getAnnotationPreference(annotation);
		if (preference == null)
			return false;
		
		String key= preference.getTextPreferenceKey();
		if (key != null)
			return fPreferences.getBoolean(key);
		key= preference.getHighlightPreferenceKey();
		return key == null || fPreferences.getBoolean(key);
	}


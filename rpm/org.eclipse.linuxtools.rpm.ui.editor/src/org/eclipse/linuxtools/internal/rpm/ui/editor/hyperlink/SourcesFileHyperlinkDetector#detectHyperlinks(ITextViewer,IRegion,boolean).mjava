	/**
	 * @see org.eclipse.jface.text.hyperlink.IHyperlinkDetector#detectHyperlinks(org.eclipse.jface.text.ITextViewer,
	 *      org.eclipse.jface.text.IRegion, boolean)
	 */
	@Override
	public IHyperlink[] detectHyperlinks(ITextViewer textViewer,
			IRegion region, boolean canShowMultipleHyperlinks) {
		boolean patchExists = false;
		if (region == null || textViewer == null) {
			return null;
		}

		if (editor == null) {
			editor = ((SpecfileEditor) this.getAdapter(SpecfileEditor.class));
			if (editor == null) {
				return null;
			}
		}

		IDocument document = textViewer.getDocument();

		int offset = region.getOffset();

		if (document == null) {
			return null;
		}
		IRegion lineInfo;
		String line;
		try {
			lineInfo = document.getLineInformationOfOffset(offset);
			line = document.get(lineInfo.getOffset(), lineInfo.getLength());
		} catch (BadLocationException ex) {
			return null;
		}
		if (editor.getEditorInput() instanceof FileEditorInput) {
			IFile original = ((FileEditorInput) editor.getEditorInput())
					.getFile();
			if (line.startsWith(SOURCE_IDENTIFIER)
					|| line.startsWith(PATCH_IDENTIFIER)) {
				int delimiterIndex = line.indexOf(':') + 1;
				String fileName = line.substring(delimiterIndex).trim();
				patchExists = patchExists(original, fileName);
				if (region.getOffset() > lineInfo.getOffset()
						+ line.indexOf(fileName)) {
					IRegion fileNameRegion = new Region(lineInfo.getOffset()
							+ line.indexOf(fileName), fileName.length());
					if (line.startsWith(PATCH_IDENTIFIER) && !patchExists) {
						return new IHyperlink[] {
								new SourcesFileCreateHyperlink(original, UiUtils
										.resolveDefines(editor.getSpecfile(),
												fileName), fileNameRegion) };
					} else {
						return new IHyperlink[] {
								new SourcesFileHyperlink(original, UiUtils
										.resolveDefines(editor.getSpecfile(),
												fileName), fileNameRegion),
								new SourcesFileDownloadHyperlink(original, UiUtils
										.resolveDefines(editor.getSpecfile(),
												fileName), fileNameRegion) };
					}
				}
			}
		}

		return null;
	}


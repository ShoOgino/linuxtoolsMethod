	private void parseSpecfile(DocumentRangeNode root, IDocument doc,
			IProgressMonitor monitor) {
		try {
			SpecfileParser parser = new SpecfileParser();
			Specfile specfile = parser.parse(doc);
			String id = specfile.getName();
			SpecNode parent = new SpecNode(root, 0, id, doc, 0, doc.getLength());
			monitor = beginWork(monitor);
			for (SpecfileSection sec : specfile.getSections()) {
				try {
					addNode(parent, doc, sec.getName(), doc.getLineOffset(sec
							.getLineNumber()), doc.getLineOffset(sec
							.getSectionEndLine())
							- doc.getLineOffset(sec.getLineNumber()));
				} catch (BadLocationException e) {
					SpecfileLog.logError(e);
				}
			}
			for (SpecfilePackage sPackage : specfile.getPackages()
					.getPackages()) {
				try {
					SpecNode pNode = addNode(parent, doc, sPackage
							.getPackageName(), doc.getLineOffset(sPackage
							.getLineNumber()), doc.getLineOffset(sPackage
							.getSectionEndLine())
							- doc.getLineOffset(sPackage.getLineNumber()));
					for (SpecfileSection section : sPackage.getSections()) {
						addNode(pNode, doc, section.getName(), doc
								.getLineOffset(section.getLineNumber()), doc
								.getLineOffset(section.getSectionEndLine())
								- doc.getLineOffset(section.getLineNumber()));
					}
				} catch (BadLocationException e) {
					SpecfileLog.logError(e);
				}
			}
		} finally {
			monitor.done();
		}
	}


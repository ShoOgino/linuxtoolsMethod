    /**
     * Adds style information to the given text presentation.
     *
     * @param presentation the text presentation to be extended
     * @param offset the offset of the range to be styled
     * @param length the length of the range to be styled
     * @param attr the attribute describing the style of the range to be styled
     */
    protected void addRange(
        TextPresentation presentation,
        int offset,
        int length,
        TextAttribute attr) {
        if (attr != null) {
            presentation.addStyleRange(
                new StyleRange(
                    offset,
                    length,
                    attr.getForeground(),
                    attr.getBackground(),
                    attr.getStyle()));
        }
    }


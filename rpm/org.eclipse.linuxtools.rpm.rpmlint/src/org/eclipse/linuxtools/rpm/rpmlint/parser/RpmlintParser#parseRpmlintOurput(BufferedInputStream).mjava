	/**
	 * Parse a given rpmlint <code>InputStream</code>
	 * 
	 * @param 
	 * 		rpmlint <code>InputStream</code> to parse.
	 * @return
	 * 		a <code>RpmlintItem</code> ArrayList.
	 */
	private ArrayList<RpmlintItem> parseRpmlintOurput(BufferedInputStream in) {
		RpmlintItem item =  new RpmlintItem();
		ArrayList<RpmlintItem> rpmlintItems = new ArrayList<RpmlintItem>();
		LineNumberReader reader = new LineNumberReader(new InputStreamReader(in));
		String line;
		boolean firtItemLine = true;
		String[] lineItems;
		String description = "";
		try {
			while ((line = reader.readLine()) != null) {
				if (firtItemLine) {
					firtItemLine=false;
					lineItems = line.split(":", 4);
					item.setFileName(lineItems[0]);
					int lineNbr;
					
					
					// FIXME: last rpmlint version (0.83) contain a summary 
					// line at the bottom of it output, so if we 
					// detected this line we can safely return rpmlintItems, 
					// maybe we can find a better way to detect this line. 
					try {
						Integer.parseInt(line.split(" ")[0]);
						return rpmlintItems;
					} catch (NumberFormatException e) {
						// this line is not the summary
					}					
					
					// TODO: ask rpmlint upstream to display always the same output.
					// at the moment the line number is not always displayed.
					// If the same output is always used, all the workarounds for the line number can be
					// removed.
					try {
						lineNbr = Integer.parseInt(lineItems[1]);
						item.setSeverity(lineItems[2]);
						lineItems = lineItems[3].trim().split(" ", 2);						
					} catch (NumberFormatException e) {
						// No line number showed for this rpmlint warning.
						lineItems = line.split(":", 3);
						lineNbr = -1;
						item.setSeverity(lineItems[1]);
						lineItems = lineItems[2].trim().split(" ", 2);
					} 
					item.setLineNbr(lineNbr);					
					item.setId(lineItems[0]);
					// get content
					if (lineItems.length > 1)
						item.setReferedContent(lineItems[1]);
					else
						item.setReferedContent("");
				} else {
					description += line + '\n';
				}
				
				if (line.equals("")) {
					item.setMessage(description.substring(0, description.length() - 2));
					int useOfTabsAndSpaces = getMixedUseOfTabsAndSpaces(item.getReferedContent());
					if (useOfTabsAndSpaces != -1) 
						item.setLineNbr(useOfTabsAndSpaces);
					rpmlintItems.add(item);
					item = new RpmlintItem();
					firtItemLine=true;
					description = "";
				}

			}
			// Close the input stream
			in.close();
		} catch (IOException e) {
			RpmlintLog.logError(e);
		}
		return rpmlintItems;
	}


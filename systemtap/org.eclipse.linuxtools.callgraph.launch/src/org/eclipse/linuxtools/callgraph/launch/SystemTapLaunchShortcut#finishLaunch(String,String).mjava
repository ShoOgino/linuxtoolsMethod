	/**
	 * Helper function to complete launches. Uses protected parameters (Strings)
	 * scriptPath, binaryPath, arguments, outputPath and (boolean) overwrite.
	 * These must be set by the calling function (or else nonsensical results
	 * will occur). <br>
	 * If scriptPath has not been set, the setScriptPath() method will be
	 * called.
	 * 
	 * @param name
	 *            : Used to generate the name of the new configuration
	 * @param bin
	 *            : Affiliated executable
	 * @param mode
	 *            : Mode setting
	 * @throws Exception
	 */
	protected void finishLaunch(String name, String mode) throws Exception {
		if (!finishLaunchHelper())
			return;

		ILaunchConfigurationWorkingCopy wc = null;
		if (config != null) {
			try {
				wc = config.getWorkingCopy(); //$NON-NLS-1$
			} catch (CoreException e1) {
				e1.printStackTrace();
			}

			wc.setAttribute(LaunchConfigurationConstants.SCRIPT_PATH,scriptPath);

			if (!invalid(binaryPath))
				wc.setAttribute(LaunchConfigurationConstants.BINARY_PATH,binaryPath);

			wc.setAttribute(LaunchConfigurationConstants.OUTPUT_PATH,outputPath);
			wc.setAttribute(LaunchConfigurationConstants.ARGUMENTS, arguments);
			wc.setAttribute(LaunchConfigurationConstants.GENERATED_SCRIPT,generatedScript);
			wc.setAttribute(LaunchConfigurationConstants.NEED_TO_GENERATE,needToGenerate);
			wc.setAttribute(LaunchConfigurationConstants.OVERWRITE, overwrite);
			wc.setAttribute(LaunchConfigurationConstants.USE_COLOUR,useColours);
			wc.setAttribute(LaunchConfigurationConstants.PARSER_CLASS,parserID);
			wc.setAttribute(LaunchConfigurationConstants.VIEW_CLASS, viewID);
			wc.setAttribute(LaunchConfigurationConstants.SECONDARY_VIEW_ID, setSecondaryViewID());

			try {
				config = wc.doSave();
			} catch (CoreException e) {
				e.printStackTrace();
			}

			checkForExistingConfiguration();

			if (!testMode)
				DebugUITools.launch(config, mode);
		} else
			throw new Exception(
					Messages
							.getString("SystemTapLaunchShortcut.NullConfiguration") + name); //$NON-NLS-1$

	}


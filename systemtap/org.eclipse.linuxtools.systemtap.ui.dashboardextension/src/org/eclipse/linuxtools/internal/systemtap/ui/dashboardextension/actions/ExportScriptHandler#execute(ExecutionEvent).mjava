	@Override
	public Object execute(ExecutionEvent event) {
		String script = getFilePath();
		if(null == script || script.length() <= 0) {
			String msg = MessageFormat.format(Localization.getString("ExportScriptAction.NoFileToExport"), (Object[])null); //$NON-NLS-1$
			MessageDialog.openWarning(PlatformUI.getWorkbench().getActiveWorkbenchWindow().getShell(), Localization.getString("ExportScriptAction.Error"), msg); //$NON-NLS-1$
		} else {
			DataSetWizard wizard = new DataSetWizard(GraphingConstants.DataSetMetaData, script);
			IWorkbench workbench = PlatformUI.getWorkbench();
			wizard.init(workbench, null);
			WizardDialog dialog = new WizardDialog(workbench.getActiveWorkbenchWindow().getShell(), wizard);
			dialog.create();
			dialog.open();

			IDataSetParser parser = wizard.getParser();
			IDataSet dataSet = wizard.getDataSet();

			wizard.dispose();

			if(null == parser || null == dataSet)
				return null;

			ExportScriptDialog exportDialog = new ExportScriptDialog(PlatformUI.getWorkbench().getActiveWorkbenchWindow().getShell(), dataSet);
			exportDialog.create();

			if(exportDialog.open() == Window.OK) {
				String category = exportDialog.getCategory();
				String display = exportDialog.getDisplay();
				String description = exportDialog.getDescription();
				GraphData[] gd = exportDialog.getGraphs();
				TreeNode filters = exportDialog.getGraphFilters();

				validateDirectory();
				File meta = saveMetaData(display, category, description, dataSet, parser, gd, filters,"local"); //$NON-NLS-1$
				String archiveName = getSaveDirectory() + "/" + category.replace(' ', '_') + "." + display.replace(' ', '_'); //$NON-NLS-1$ //$NON-NLS-2$
				buildArchive(archiveName, new File(script), meta);
				cleanupFiles(new String[] {archiveName, meta.getAbsolutePath()});
				updateDashboard();
			}
		}
		return null;
	}


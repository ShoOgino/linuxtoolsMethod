	/**
	 * Scan the next events from all traces and return the next one
	 * in chronological order.
	 * 
	 * @param context
	 * @return
	 */
	public synchronized TmfEvent getNextEvent(TmfContext context) {
		if (context instanceof TmfExperimentContext) {
			TmfExperimentContext expContext = (TmfExperimentContext) context;
			int trace = 0;
			TmfTimestamp timestamp = TmfTimestamp.BigCrunch;
			if (expContext.getEvents()[trace] != null) {
				timestamp = expContext.getEvents()[trace].getTimestamp();
			}
			for (int i = 1; i < expContext.getTraces().length; i++) {
				if (expContext.getEvents()[i].getTimestamp() != null) {
					TmfTimestamp otherTS = expContext.getEvents()[i].getTimestamp();
					if (otherTS.compareTo(timestamp, true) < 0) {
						trace = i;
						timestamp = otherTS;
					}
				}
			}
			TmfContext trcloc = expContext.getContexts()[trace];
			TmfEvent event = expContext.getTraces()[trace].parseEvent(trcloc);
			TmfExperimentLocation exploc = (TmfExperimentLocation) expContext.getLocation();
			exploc.getLocations()[trace] = trcloc.getLocation().clone();
			expContext.updateRank(1);
			expContext.getEvents()[trace] = expContext.getTraces()[trace].getNextEvent(trcloc);
			return event;
		}
    	return null;
	}


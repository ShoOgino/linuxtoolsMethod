	/**
	 * Scan the next events from all traces and return the next one
	 * in chronological order.
	 * 
	 * @param context
	 * @return
	 */
	public synchronized TmfEvent getNextEvent(TmfContext context) {
		if (context instanceof TmfExperimentContext) {
			TmfExperimentContext expContext = (TmfExperimentContext) context;
			int trace = -1;
			TmfTimestamp timestamp = TmfTimestamp.BigCrunch;
			for (int i = 0; i < expContext.getTraces().length; i++) {
				if (expContext.getEvents()[i] != null) {
					if (expContext.getEvents()[i].getTimestamp() != null) {
						TmfTimestamp otherTS = expContext.getEvents()[i].getTimestamp();
						if (otherTS.compareTo(timestamp, true) < 0) {
							trace = i;
							timestamp = otherTS;
						}
					}
				}
			}

			if (trace >= 0) {
				TmfContext trcloc = expContext.getContexts()[trace];
				TmfEvent event = expContext.getTraces()[trace].getNextEvent(trcloc);
				TmfExperimentLocation exploc = (TmfExperimentLocation) expContext.getLocation();
				exploc.getLocation()[trace] = trcloc.getLocation().clone();
				expContext.getEvents()[trace] = expContext.getTraces()[trace].parseEvent(trcloc);
				expContext.updateRank(1);
				return event;
			}
		}
    	return null;
	}


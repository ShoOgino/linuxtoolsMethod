    private static StructDeclaration newFlattenedStruct(@NonNull StructDeclaration sd) {
        StructDeclaration flatStruct = new StructDeclaration(sd.getAlignment());
        for (String name : sd.getFieldsList()) {
            depthFirstAdd(name, flatStruct, sd.getField(name));
        }
        return flatStruct;
    }


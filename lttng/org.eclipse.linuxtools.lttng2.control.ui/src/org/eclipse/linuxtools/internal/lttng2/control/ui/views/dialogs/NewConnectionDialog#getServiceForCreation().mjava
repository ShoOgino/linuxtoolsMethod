    private IRemoteServices getServiceForCreation() {
        Object o = ((IStructuredSelection) fConnectionTree.getSelection()).getFirstElement();
        IRemoteServices result = null;
        if (o instanceof IRemoteServices) {
            result = (IRemoteServices) o;
        } else if (o instanceof IRemoteConnection) {
            result = ((IRemoteConnection) o).getRemoteServices();
        } else {
            return null;
        }

        if ((result.getCapabilities() & IRemoteServices.CAPABILITY_ADD_CONNECTIONS) == 0) {
            return null;
        }

        return result;
    }


    private boolean isBackedByShell() throws InterruptedException {
        if (fBackedByShell == 0) {
            String cmd= SHELL_ECHO_CMD + BEGIN_TAG + CMD_SEPARATOR + SHELL_ECHO_CMD + END_TAG;
            IRemoteProcessBuilder pb = fConnection.getProcessBuilder(cmd.trim().split("\\s+")); //$NON-NLS-1$
            pb.redirectErrorStream(true);
            IRemoteProcess process = null;
            InputReader reader = null;
            try {
                process = pb.start();
                reader = new InputReader(process.getInputStream());
                reader.waitFor(new NullProgressMonitor());
                process.waitFor();

                fBackedByShell = -1;
                String result= reader.toString();
                int pos = result.indexOf(BEGIN_TAG, skipEchoBeginTag(result));
                if (pos >= 0 && result.substring(pos + BEGIN_TAG.length()).trim().startsWith(END_TAG)) {
                    fBackedByShell = 1;
                }
            } catch (IOException e) {
                // On Windows, cannot start built-in echo command
                fBackedByShell = -1;
            } finally {
                if (process != null) {
                    process.destroy();
                }
                if (reader != null) {
                    reader.stop();
                }
            }
        }
        return fBackedByShell == 1;
    }


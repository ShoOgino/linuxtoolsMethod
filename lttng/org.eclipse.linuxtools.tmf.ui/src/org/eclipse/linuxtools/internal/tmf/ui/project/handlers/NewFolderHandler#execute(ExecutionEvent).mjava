    @Override
    public Object execute(ExecutionEvent event) throws ExecutionException {

        // Check if we are closing down
        IWorkbenchWindow window = PlatformUI.getWorkbench().getActiveWorkbenchWindow();
        if (window == null) {
            return null;
        }

        ISelection selection = HandlerUtil.getCurrentSelection(event);
        if (!(selection instanceof IStructuredSelection)) {
            return null;
        }
        final Object element = ((IStructuredSelection) selection).getFirstElement();
        if (!(element instanceof TmfTraceFolder)) {
            return null;
        }
        TmfTraceFolder parent = (TmfTraceFolder) element;

        // Fire the New Folder dialog
        Shell shell = window.getShell();
        NewFolderDialog dialog = new NewFolderDialog(shell, parent);
        dialog.open();

        return null;
    }


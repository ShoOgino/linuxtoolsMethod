    @Override
    public void setEnabled(Object evaluationContext) {
        super.setEnabled(evaluationContext);

        fEnabled = true;

        Object s = HandlerUtil.getVariable(evaluationContext, ISources.ACTIVE_MENU_SELECTION_NAME);
        if (s instanceof IStructuredSelection) {
            IStructuredSelection selection = (IStructuredSelection) s;
            // If we have traces selected, make sure they are all from the same
            // project, disable handler otherwise
            Object[] selectedElements = selection.toArray();
            TmfProjectElement firstProject = null;
            for (Object selectedElement : selectedElements) {
                if (selectedElement instanceof TmfTraceElement) {
                    TmfTraceElement tmfTraceElement = (TmfTraceElement) selectedElement;
                    TmfProjectElement project = tmfTraceElement.getProject();
                    if (firstProject != null && !project.equals(firstProject)) {
                        fEnabled =  false;
                    }

                    firstProject = project;
                }
            }
        }
    }


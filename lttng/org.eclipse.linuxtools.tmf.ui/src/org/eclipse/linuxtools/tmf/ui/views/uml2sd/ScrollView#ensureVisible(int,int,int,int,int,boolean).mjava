    /**
     * Make rectangle (xValue,yValue,width,height, in contents coordinates) visible. if rectangle cannot be completely visible, use
     * align flags.
     * 
     * @param xValue x contents coordinates of rectangle.
     * @param yValue y contents coordinates of rectangle.
     * @param width width of rectangle.
     * @param height height of rectangle.
     * @param align bit or'ed SWT flag like SWT.LEFT,RIGHT,CENTER,TOP,BOTTOM,VERTICAL used only for bigger rectangle
     *            than visible area. By default CENTER/VERTICAL
     * @param forceAlign force alignment for rectangle smaller than the visible area
     */
    protected void ensureVisible(int xValue, int yValue, int width, int height, int align, boolean forceAlign) {
        
        int localWidth = width;
        int localHeight = height;

        if (localWidth < 0) {
            xValue = xValue + localWidth;
            localWidth = -localWidth;
        }
        if (localHeight < 0) {
            yValue = yValue + localHeight;
            localHeight = -localHeight;
        }
        int hbar = getHorizontalBarHeight();
        int vbar = getVerticalBarWidth();
        int cx = getContentsX(), cy = getContentsY();
        int right = getContentsX() + getVisibleWidth() - vbar;
        int bottom = getContentsY() + getVisibleHeight() - hbar;
        boolean align_h = false, align_v = false;

        if (xValue < getContentsX()) {
            cx = xValue;
        } else if (xValue + localWidth > right) {
            cx = xValue - localWidth;
        }
        if (yValue < getContentsY()) {
            cy = yValue;
        } else if (yValue + localHeight > bottom) {
            cy = yValue - localHeight;
        }

        if (localWidth > getVisibleWidth()) {
            align_h = true;
        }
        if (localHeight > getVisibleHeight()) {
            align_v = true;
        }
        // compute alignment on visible area horizontally
        if (align_h || (forceAlign && xValue + localWidth > right)) {
            // use align flags
            if ((align & SWT.LEFT) != 0) {
                cx = xValue;
            } else if ((align & SWT.RIGHT) != 0) {
                cx = right - localWidth;
            } else { // center
                cx = xValue + (localWidth - getVisibleWidth()) / 2;
            }
        }
        // compute alignment on visible area vertically
        if (align_v || (forceAlign && yValue + localHeight > bottom)) {
            // use align flags
            if ((align & SWT.TOP) != 0) {
                cy = yValue;
            } else if ((align & SWT.BOTTOM) != 0) {
                cy = bottom - localHeight;
            } else { // center
                cy = yValue + (localHeight - getVisibleHeight()) / 2;
            }
        }
        setContentsPos(cx, cy);
    }


    /**
     * Requests all the data of the experiment to the state system which
     * contains information about the statistics.
     *
     * Since the viewer may be listening to multiple traces, it have to receive
     * the experiment rather than a single trace. The filtering is done with the
     * method {@link #isListeningTo(String trace)}.
     *
     * @param experiment
     *            The experiment for which a request must be done
     * @param timeRange
     *            The time range that will be requested to the state system
     * @param isGlobal
     *            Tells if the request is for the global event count or the
     *            partial one.
     */
    private void buildStatisticsTree(final TmfExperiment experiment, TmfTimeRange timeRange, boolean isGlobal) {
        final TmfStatisticsTreeNode statTree = TmfStatisticsTreeManager.getStatTreeRoot(getTreeID());
        final TmfStatisticsTree statsData = TmfStatisticsTreeManager.getStatTree(getTreeID());
        if (statsData == null) {
            return;
        }

        synchronized (statsData) {
            if (isGlobal) {
                statTree.resetGlobalValue();
            } else {
                statTree.resetTimeRangeValue();
            }

            /*
             * Checks each trace in the experiment, since the viewer may be
             * listening to multiple traces.
             */
            for (final ITmfTrace trace : experiment.getTraces()) {
                if (!isListeningTo(trace)) {
                    continue;
                }

                /* Retrieves the statistics object */
                final ITmfStatistics stats = trace.getStatistics();
                if (stats == null) {
                    /*
                     * The statistics provider for this trace is not accessible
                     * (yet?). Try the next one.
                     */
                    continue;
                }

                /* The generic statistics are stored in nanoseconds, so we must make
                 * sure the time range is scaled correctly. */
                ITmfTimestamp start = timeRange.getStartTime().normalize(0, TIME_SCALE);
                ITmfTimestamp end = timeRange.getEndTime().normalize(0, TIME_SCALE);

                /*
                 * Send a request to update the statistics view. The result will
                 * be sent through a {@link TmfStatsUpdatedSignal}, and will be
                 * processed by the signal handler.
                 */
                trace.getStatistics().updateStats(isGlobal, start, end);
            }
        }
    }


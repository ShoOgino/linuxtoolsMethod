    public boolean okPressed() {
        fPrintAll = fAllPages.getSelection();
        fPrintCurrent = fCurrentPage.getSelection();
        fPrintSelection = fPageList.getSelection();
        fPrintRange = fPageRange.getSelection();
        try {
            if (fPrintRange) {
                fFrom = Integer.valueOf(fFromPage.getText()).intValue();
                fTo = Integer.valueOf(fToPage.getText()).intValue();
                if (fFrom > maxNumOfPages() || fTo > maxNumOfPages() || fFrom <= 0 || fTo <= 0) {
                    MessageDialog.openError(getShell(), SDMessages._98, SDMessages._99);
                    return false;
                }
            } else if (fSetHPagesNumber.getSelection() && fNbPages <= 0) {
                MessageDialog.openError(getShell(), SDMessages._98, SDMessages._101);
                return false;
            } else if (fSetVPagesNumber.getSelection() && fNbPages <= 0) {
                MessageDialog.openError(getShell(), SDMessages._98, SDMessages._100);
                return false;
            } else if (fPrintSelection && getPageList().length <= 0) {
                MessageDialog.openError(getShell(), SDMessages._98, SDMessages._102);
                return false;
            }

        } catch (Exception e) {
            MessageDialog.openError(getShell(), SDMessages._98, SDMessages._99);
            fFrom = 0;
            fTo = 0;
            return false;
        }

        return true;
    }


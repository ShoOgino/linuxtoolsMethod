	@Override
    public boolean isEnabled() {
        
        // Check if we are closing down
        IWorkbenchWindow window = PlatformUI.getWorkbench().getActiveWorkbenchWindow();
        if (window == null)
            return false;

        // Check if a trace is selected
        IWorkbenchPage page = window.getActivePage();
        if (!(page.getActivePart() instanceof ProjectView))
            return false;
        fProjectView = (ProjectView) page.getActivePart();

        // Check if a trace is selected
        ISelection selection = page.getSelection(ProjectView.ID);
        if (selection instanceof StructuredSelection) {
            Object element = ((StructuredSelection) selection).getFirstElement();
            fTrace = (element instanceof TmfTraceNode) ? (TmfTraceNode) element : null;
        }

        return (fTrace != null);
    }


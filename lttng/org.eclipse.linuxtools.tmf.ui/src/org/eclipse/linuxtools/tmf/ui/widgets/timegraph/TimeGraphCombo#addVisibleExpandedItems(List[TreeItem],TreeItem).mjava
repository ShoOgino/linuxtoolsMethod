    private void addVisibleExpandedItems(List<TreeItem> items, TreeItem treeItem) {
        for (TreeItem item : treeItem.getItems()) {
            items.add(item);
            if (item.getExpanded()) {
                addVisibleExpandedItems(items, item);
            }
        }
    }


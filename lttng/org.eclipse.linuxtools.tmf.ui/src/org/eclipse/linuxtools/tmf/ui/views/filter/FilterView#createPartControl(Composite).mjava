    @Override
    public void createPartControl(Composite parent) {

        fViewer = new FilterViewer(parent, SWT.NONE);
        fViewer.setInput(fRoot);

        contributeToActionBars();

        fViewer.addSelectionChangedListener(new ISelectionChangedListener() {
            @Override
            public void selectionChanged(SelectionChangedEvent event) {
                if (!(event.getSelection().isEmpty()) && event.getSelection() instanceof IStructuredSelection) {
                    fExportAction.setEnabled(true);
                } else {
                    fExportAction.setEnabled(false);
                }
            }
        });
        this.getSite().setSelectionProvider(fViewer.getTreeViewer());

        // Adds root context menu
        MenuManager menuManager = new MenuManager();
        menuManager.setRemoveAllWhenShown(true);
        menuManager.addMenuListener(new IMenuListener() {
            @Override
            public void menuAboutToShow(IMenuManager manager) {
                fViewer.fillContextMenu(manager);
            }
        });
        Menu contextMenu = menuManager.createContextMenu(fViewer.getTreeViewer().getTree());
        fViewer.getTreeViewer().getTree().setMenu(contextMenu);
        this.getSite().registerContextMenu(menuManager, fViewer.getTreeViewer());
    }


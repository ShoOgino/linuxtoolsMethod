    private IResource renameTrace(final String newName) {

        final IPath oldPath = fTrace.getResource().getFullPath();
        final IPath newPath = oldPath.append("../" + newName); //$NON-NLS-1$

        WorkspaceModifyOperation operation = new WorkspaceModifyOperation() {
            @Override
            public void execute(IProgressMonitor monitor) throws CoreException {
                try {
                    monitor.beginTask("", 1000); //$NON-NLS-1$
                    if (monitor.isCanceled()) {
                        throw new OperationCanceledException();
                    }
                    // Close the trace if open
                    IFile file = fTrace.getBookmarksFile();
                    FileEditorInput input = new FileEditorInput(file);
                    IWorkbench wb = PlatformUI.getWorkbench();
                    for (IWorkbenchWindow wbWindow : wb.getWorkbenchWindows()) {
                        for (IWorkbenchPage wbPage : wbWindow.getPages()) {
                            for (IEditorReference editorReference : wbPage.getEditorReferences()) {
                                if (editorReference.getEditorInput().equals(input)) {
                                    wbPage.closeEditor(editorReference.getEditor(false), false);
                                }
                            }
                        }
                    }
                    TmfExperimentFolder experimentFolder = fTrace.getProject().getExperimentsFolder();
                    for (final ITmfProjectModelElement experiment : experimentFolder.getChildren()) {
                        for (final ITmfProjectModelElement trace : experiment.getChildren()) {
                            if (trace.equals(fTrace)) {
                                // Close the experiment if open
                                file = ((TmfExperimentElement) experiment).getBookmarksFile();
                                input = new FileEditorInput(file);
                                for (IWorkbenchWindow wbWindow : wb.getWorkbenchWindows()) {
                                    for (IWorkbenchPage wbPage : wbWindow.getPages()) {
                                        for (IEditorReference editorReference : wbPage.getEditorReferences()) {
                                            if (editorReference.getEditorInput().equals(input)) {
                                                wbPage.closeEditor(editorReference.getEditor(false), false);
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }

                    if (fTrace.getResource() instanceof IFolder) {
                        IFolder folder = (IFolder) fTrace.getResource();
                        IFile bookmarksFile = fTrace.getBookmarksFile();
                        IFile newBookmarksFile = folder.getFile(bookmarksFile.getName().replace(fTrace.getName(), newName));
                        if (bookmarksFile.exists()) {
                            if (!newBookmarksFile.exists()) {
                                IPath newBookmarksPath = newBookmarksFile.getFullPath();
                                bookmarksFile.move(newBookmarksPath, IResource.FORCE | IResource.SHALLOW, null);
                            }
                        }
                    }

                    fTrace.renameSupplementaryFolder(newName);
                    fTrace.getResource().move(newPath, IResource.FORCE | IResource.SHALLOW, null);
                    if (monitor.isCanceled()) {
                        throw new OperationCanceledException();
                    }
                } finally {
                    monitor.done();
                }
            }
        };

        try {
            PlatformUI.getWorkbench().getProgressService().busyCursorWhile(operation);
        } catch (InterruptedException exception) {
            return null;
        } catch (InvocationTargetException exception) {
            MessageDialog.openError(getShell(), "", exception.getTargetException().getMessage()); //$NON-NLS-1$
            return null;
        } catch (RuntimeException exception) {
            return null;
        }

        return fTrace.getResource();
    }


    private void refreshSelection() {
        int lastRowOffset = fTableTopEventRank + fTableRows - 1;
        int startRank = Math.min(fSelectedBeginRank, fSelectedEventRank);
        int endRank = Math.max(fSelectedBeginRank, fSelectedEventRank);
        int start = Integer.MAX_VALUE;
        int end = Integer.MIN_VALUE;
        if (startRank < fFrozenRowCount) {
            start = startRank;
        } else if (startRank < fTableTopEventRank + fFrozenRowCount) {
            start = fFrozenRowCount;
        } else if (startRank <= lastRowOffset) {
            start = startRank - fTableTopEventRank;
        }
        if (endRank < fFrozenRowCount) {
            end = endRank;
        } else if (endRank < fTableTopEventRank + fFrozenRowCount) {
            end = fFrozenRowCount - 1;
        } else if (endRank <= lastRowOffset) {
            end = endRank - fTableTopEventRank;
        } else {
            end = fTableRows - 1;
        }
        if (start <= end) {
            fTable.setSelection(start, end);
            if (startRank == fSelectedEventRank) {
                fTable.select(start);
            } else {
                fTable.select(end);
            }
        } else {
            fTable.deselectAll();
        }
    }


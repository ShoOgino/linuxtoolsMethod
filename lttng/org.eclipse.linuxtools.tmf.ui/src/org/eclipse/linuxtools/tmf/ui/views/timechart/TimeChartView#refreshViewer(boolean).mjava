    private void refreshViewer(boolean resetTimeIntervals) {
        if (fComposite == null) {
            return;
        }
        synchronized (fSyncObj) {
            if (fRefreshBusy) {
                fRefreshPending = true;
                return;
            } else {
                fRefreshBusy = true;
            }
        }
        final boolean reset = resetTimeIntervals;
        // Perform the refresh on the UI thread
        Display.getDefault().asyncExec(new Runnable() {
            @Override
            public void run() {
                if (fComposite.isDisposed())
                    return;
                fViewer.display(fTimeAnalysisEntries.toArray(new TimeChartAnalysisEntry[0]));
                if (reset) {
                    fViewer.resetStartFinishTime();
                }
                synchronized (fSyncObj) {
                    fRefreshBusy = false;
                    if (fRefreshPending) {
                        fRefreshPending = false;
                        refreshViewer(reset);
                    }
                }
            }
        });
    }


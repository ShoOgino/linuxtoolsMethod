    /**
     * Handle mouse-based selection in table.
     *
     * @param event the mouse event
     */
    private void handleTableMouseEvent(MouseEvent event) {
        TableItem item = fTable.getItem(new Point(event.x, event.y));
        if (item == null) {
            return;
        }
        int selectedRow = indexOf(item);
        if (event.button != 2) {
            if (selectedRow >= 0) {
                fSelectedEventRank = selectedRow;
            } else {
                fSelectedEventRank = -1;
            }
            if ((event.stateMask & SWT.SHIFT) == 0 || (fTable.getStyle() & SWT.MULTI) == 0 || fSelectedBeginRank == -1) {
                fSelectedBeginRank = fSelectedEventRank;
            }
        }
        refreshSelection();

        /*
         * Feature in Linux. When a partially visible table item is selected,
         * the origin is changed to ensure the selected item is fully visible.
         * This makes the first row partially visible. The solution is to force
         * reset the origin by setting the top index to 0. This should happen
         * only once at the next redraw by the paint listener.
         */
        if (selectedRow >= fFullyVisibleRows) {
            fResetTopIndex = true;
        }
    }


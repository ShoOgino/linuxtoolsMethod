    private void addContributionItem(LinkedList<IContributionItem> list,
            String traceBundle, String traceTypeId, String traceIcon, String label, boolean selected,
            MenuManager subMenu) {
        Map<String, String> params;
        
        params = new HashMap<String, String>();
        params.put(BUNDLE_PARAMETER, traceBundle);
        params.put(TYPE_PARAMETER, traceTypeId);
        params.put(ICON_PARAMETER, traceIcon);

        ImageDescriptor icon = null;
        if (selected) {
            icon = SELECTED_ICON;
        }

        CommandContributionItemParameter param = new CommandContributionItemParameter(PlatformUI.getWorkbench()
                .getActiveWorkbenchWindow(), "my.parameterid", // id //$NON-NLS-1$
                SELECT_TRACE_TYPE_COMMAND_ID, // commandId
                params, // parameters
                icon, // icon
                icon, // disabled icon
                icon, // hover icon
                label, // label
                null, // mnemonic
                null, // tooltip
                CommandContributionItem.STYLE_PUSH, // style
                null, // help context id
                true // visibleEnable
        );

        if (subMenu != null) {
            subMenu.add(new CommandContributionItem(param));
        } else {
            list.add(new CommandContributionItem(param));
        }
    }


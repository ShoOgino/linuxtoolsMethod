    /**
     * Handle selection of print button.
     */
    public void printButtonSelected() {
        PrintDialog printer = new PrintDialog(getShell());
        if (fAllPages.getSelection()) {
            printer.setScope(PrinterData.ALL_PAGES);
        }
        if (fCurrentPage.getSelection()) {
            printer.setScope(PrinterData.SELECTION);
        }
        if (fPageList.getSelection()) {
            printer.setScope(PrinterData.SELECTION);
        }
        if (fPageRange.getSelection()) {
            printer.setScope(PrinterData.PAGE_RANGE);
            fFrom = Integer.valueOf(fFromPage.getText()).intValue();
            fTo = Integer.valueOf(fToPage.getText()).intValue();
            printer.setStartPage(fFrom);
            printer.setEndPage(fTo);
        }

        PrinterData newPrinterData = printer.open();
        if (newPrinterData != null) {
            fPrinterData = newPrinterData;
        }
        updatePrinterStatus();

        if (printer.getScope() == PrinterData.ALL_PAGES) {
            fAllPages.setSelection(true);
            fCurrentPage.setSelection(false);
            fPageList.setSelection(false);
            fPageRange.setSelection(false);
            fHorPagesNum.setEnabled(false);
            fVertPagesNum.setEnabled(false);
        }
        if (printer.getScope() == PrinterData.PAGE_RANGE) {
            fAllPages.setSelection(false);
            fCurrentPage.setSelection(false);
            fPageList.setSelection(false);
            fPageRange.setSelection(true);
            fFromPage.setEnabled(true);
            fToPage.setEnabled(true);
            fFromPage.setText((Integer.valueOf(printer.getStartPage())).toString());
            fToPage.setText((Integer.valueOf(printer.getEndPage())).toString());
        }
        computeStepXY();
        fOverviewCanvas.redraw();
    }


    /**
     * Method refresh.
     */
    public void refresh() {
        boolean done = refreshTable();
        if (!done) {
            return;
        }
        if (fPendingSelection) {
            fPendingSelection = false;
            TableItem item = null;
            if (fSelectedEventRank >= 0 && fSelectedEventRank < fFrozenRowCount) {
                item = fTable.getItem(fSelectedEventRank);
            } else if (fSelectedEventRank >= fTableTopEventRank + fFrozenRowCount && fSelectedEventRank - fTableTopEventRank < fTable.getItemCount()) {
                item = fTable.getItem(fSelectedEventRank - fTableTopEventRank);
            }
            if (item != null) {
                Event e = new Event();
                e.item = item;
                fTable.notifyListeners(SWT.Selection, e);
            }
        }
    }


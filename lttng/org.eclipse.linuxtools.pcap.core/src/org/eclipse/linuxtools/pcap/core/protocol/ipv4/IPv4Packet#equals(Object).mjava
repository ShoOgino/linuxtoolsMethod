    @Override
    public boolean equals(@Nullable Object obj) {
        if (this == obj) {
            return true;
        }
        if (obj == null) {
            return false;
        }
        if (getClass() != obj.getClass()) {
            return false;
        }
        IPv4Packet other = (IPv4Packet) obj;
        final Packet child = fChildPacket;
        if (child != null) {
            if (!child.equals(other.fChildPacket)) {
                return false;
            }
        } else {
            if (other.fChildPacket != null) {
                return false;
            }
        }

        if (fDSCP != other.fDSCP) {
            return false;
        }
        if (!(fDestinationIpAddress.equals(other.fDestinationIpAddress))) {
            return false;
        }
        if (fDontFragmentFlag != other.fDontFragmentFlag) {
            return false;
        }
        if (fExplicitCongestionNotification != other.fExplicitCongestionNotification) {
            return false;
        }
        if (fFragmentOffset != other.fFragmentOffset) {
            return false;
        }
        if (fHeaderChecksum != other.fHeaderChecksum) {
            return false;
        }
        if (fIdentification != other.fIdentification) {
            return false;
        }
        if (fInternetHeaderLength != other.fInternetHeaderLength) {
            return false;
        }
        if (fIpDatagramProtocol != other.fIpDatagramProtocol) {
            return false;
        }
        if (fMoreFragmentFlag != other.fMoreFragmentFlag) {
            return false;
        }
        if (!Arrays.equals(fOptions, other.fOptions)) {
            return false;
        }
        final ByteBuffer payload = fPayload;
        if (payload != null) {
            if (!payload.equals(other.fPayload)) {
                return false;
            }
        } else {
            if (other.fPayload != null) {
                return false;
            }
        }
        if (fReservedFlag != other.fReservedFlag) {
            return false;
        }
        if (!(fSourceIpAddress.equals(other.fSourceIpAddress))) {
            return false;
        }
        if (fTimeToLive != other.fTimeToLive) {
            return false;
        }
        if (fTotalLength != other.fTotalLength) {
            return false;
        }
        if (fVersion != other.fVersion) {
            return false;
        }
        return true;
    }


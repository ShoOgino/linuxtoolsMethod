    /**
     * Parse the traces in given directory recursively
     *
     * @param directory The directory to search in
     * @param expectException Whether or not traces in this directory are expected to throw an exception when parsed
     * @throws CTFReaderException
     */
    void parseTracesInDirectory(File directory, boolean expectException) throws CTFReaderException {
        for (File file : directory.listFiles()) {
            if (file.getName().equals(METADATA_FILENAME)) {
                try {
                    new CTFTrace(directory);
                    if (expectException) {
                        fail("Trace was expected to fail parsing: " + directory);
                    }
                } catch (RuntimeException e) {
                    if (!expectException) {
                        throw new CTFReaderException("Failed parsing " + directory, e);
                    }
                } catch (CTFReaderException e) {
                    if (!expectException) {
                        throw new CTFReaderException("Failed parsing " + directory, e);
                    }
                }
                return;
            }

            if (file.isDirectory()) {
                parseTracesInDirectory(file, expectException);
            }
        }
    }


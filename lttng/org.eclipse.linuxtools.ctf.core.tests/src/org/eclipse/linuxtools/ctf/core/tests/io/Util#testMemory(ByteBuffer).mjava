    /**
     * Wrapper to make sure the bytebuffer is not null
     *
     * @param buffer
     *            a potentially null byte buffer
     * @return a non-null byte buffer or an illegal state exception
     */
    @NonNull
    public static ByteBuffer testMemory(ByteBuffer buffer) {
        if (buffer == null) {
            throw new IllegalStateException("Failed to alloc");
        }
        return buffer;
    }


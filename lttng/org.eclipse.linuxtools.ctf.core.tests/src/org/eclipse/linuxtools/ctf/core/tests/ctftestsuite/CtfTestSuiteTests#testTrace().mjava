    /**
     * Test opening and reading the trace
     */
    @Test
    public void testTrace() {
        CTFTrace trace = null;
        CTFTraceReader reader = null;
        try {
            /* Instantiate the trace object (which implies parsing the metadata) */
            trace = new CTFTrace(fTracePath);

            /* Read the trace until the end */
            reader = new CTFTraceReader(trace);
            reader.getCurrentEventDef();
            while (reader.advance()) {
                assertNotNull(reader.getCurrentEventDef());
            }

            checkIfWeShoudlSucceed();
        } catch (CTFReaderException e) {
            checkIfWeShouldFail(e);
        } catch (OutOfMemoryError e) {
            checkIfWeShouldFail(e);
        } finally {
            if (reader != null) {
                reader.dispose();
            }
            if (trace != null) {
                trace.dispose();
            }

        }
    }


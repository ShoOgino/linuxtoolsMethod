    /**
     * Get the trace type id for a resource
     *
     * @param resource
     *            the resource
     * @return the trace type id or null if it is not set
     * @throws CoreException
     *             if the trace type id cannot be accessed
     * @since 3.2
     */
    public static String getTraceTypeId(IResource resource) throws CoreException {
        String traceTypeId = resource.getPersistentProperties().get(TmfCommonConstants.TRACETYPE);
        // Fix custom trace type id with old class name or without category name for backward compatibility
        if (traceTypeId != null) {
            int index = traceTypeId.lastIndexOf(':');
            if (index != -1) {
                if (traceTypeId.contains(CustomTxtTrace.class.getSimpleName() + ':') && traceTypeId.indexOf(':') == index) {
                    traceTypeId = CustomTxtTrace.class.getCanonicalName() + ':' +
                            TmfTraceType.CUSTOM_TXT_CATEGORY + traceTypeId.substring(index);
                } else if (traceTypeId.contains(CustomXmlTrace.class.getSimpleName() + ':') && traceTypeId.indexOf(':') == index) {
                    traceTypeId = CustomXmlTrace.class.getCanonicalName() + ':' +
                            TmfTraceType.CUSTOM_XML_CATEGORY + traceTypeId.substring(index);
                }
            }
        }
        return traceTypeId;
    }


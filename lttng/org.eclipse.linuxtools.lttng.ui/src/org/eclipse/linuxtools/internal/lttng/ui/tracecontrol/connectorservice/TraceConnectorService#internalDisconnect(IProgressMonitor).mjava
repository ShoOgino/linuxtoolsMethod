    /*
     * (non-Javadoc)
     * @see org.eclipse.rse.core.subsystems.AbstractConnectorService#internalDisconnect(org.eclipse.core.runtime.IProgressMonitor)
     */
    @Override
    public void internalDisconnect(final IProgressMonitor monitor) throws Exception {
        assert !Protocol.isDispatchThread();
        final Exception[] res = new Exception[1];
        // Fire comm event to signal state about to change
        fireCommunicationsEvent(CommunicationsEvent.BEFORE_DISCONNECT);
        monitor.beginTask(Messages.Trace_Connector_Service_Disconnect_Msg + " " + getHostName(), 1); //$NON-NLS-1$
        synchronized (res) {
            Protocol.invokeLater(new Runnable() {
                @Override
                public void run() {
                    if (!disconnectTCFChannel(res, monitor)) {
                        add_to_wait_list(this);
                    }
                }
            });
            res.wait();
        }
        monitor.done();
        if (res[0] != null) {
            throw res[0];
        }
        fIsConnected = false;
    }


    /**
     * Open an existing trace.
     * <p>
     *
     * The tracepath should have been set already,
     *
     * @throws JniException
     *             If the JNI call fails
     *
     * @exception JniOpenTraceFailedException
     *                Thrown if the open failed
     */
    public void openTrace() throws JniException {

        // Raise an exception if the tracepath is empty, otherwise open the
        // trace
        if (tracepath == "") { //$NON-NLS-1$
            throw new JniTraceException("Tracepath is not set. (openTrace)"); //$NON-NLS-1$
        }

        // If the file is already opened, close it first
        if (thisTracePtr.getPointer() != NULL) {
            closeTrace();
        }

        // Initialization of the library is made here
        // It is very important that the id is kept!
        int newLibraryId = initializeLibrary();
        if (newLibraryId != -1) {
            // Call the LTT to open the trace
            // Note that the libraryId is not yet and the pointer
            long newPtr = NULL;

            try {
                newPtr = ltt_openTraceLive(newLibraryId, tracepath, printLttDebug);
            } catch (UnsatisfiedLinkError e) {
            }

            if (newPtr == NULL) {
                // JNI library doesn't support live trace read. Set flag for
                // live trace support to false and
                // open trace in offline mode.
                isLiveTraceSupported = false;
                newPtr = ltt_openTrace(newLibraryId, tracepath, printLttDebug);
            }

            if (newPtr == NULL) {
                thisTracePtr = new Jni_C_Pointer_And_Library_Id();
                throw new JniOpenTraceFailedException("Error while opening trace. Is the tracepath correct? (openTrace)"); //$NON-NLS-1$
            }

            // This is OUR pointer
            thisTracePtr = new Jni_C_Pointer_And_Library_Id(newLibraryId, newPtr);

            // Populate the trace with LTT information
            populateTraceInformation();
        } else {
        	thisTracePtr = new Jni_C_Pointer_And_Library_Id();
            throw new JniTraceException("Failed to initialize the parsing library:\n\t" + getTraceLibFullPath() //$NON-NLS-1$
                    + "\n\nIs the C library supporting that trace format properly installed?\n\n" //$NON-NLS-1$
                    +  "Make sure that:\n" //$NON-NLS-1$
                    +  "\t- The correct parsing library is installed\n" //$NON-NLS-1$
                    +  "\t- The library is accessible (LD_LIBRARY_PATH or LTTng project properties)\n" //$NON-NLS-1$
                    +  "\nRefer to the LTTng User Guide for more information"); //$NON-NLS-1$
        }
    }


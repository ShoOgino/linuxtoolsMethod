    /**
     * Test a single query to the state system for a max
     *
     * Make sure the state system has data.
     *
     * Hint: the value read should always be greater than(t / 1000)
     *
     */
    @Test
    public void testQueryMipMax() {
        assertNotNull(ssq);
        try {
            List<ITmfStateInterval> intervals = ssq.queryFullState(TEST_TIMESTAMP);
            int mipmapQuark = ssq.getQuarkAbsolute(TEST_ATTRIBUTE_NAME, AbstractTmfMipmapStateProvider.MAX_STRING);

            assertEquals("max nblevels", NB_LEVELS, intervals.get(mipmapQuark).getStateValue().unboxInt());
            for (int level = 1; level < NB_LEVELS; level++) {
                long width = (long) Math.pow(RESOLUTION, level);
                int levelQuark = ssq.getQuarkRelative(mipmapQuark, String.valueOf(level));
                ITmfStateInterval interval = intervals.get(levelQuark);
                long valueLong = interval.getStateValue().unboxLong();
                assertEquals("max value @ level " + level, width + (((TEST_TIMESTAMP - START_TIME) / INTERVAL) / width) * width, valueLong);
                assertEquals("max start time @ level " + level, START_TIME + (((TEST_TIMESTAMP - START_TIME) / INTERVAL) / width) * width * INTERVAL, interval.getStartTime());
                assertEquals("max end time @ level " + level, START_TIME + (INTERVAL * width) + (((TEST_TIMESTAMP - START_TIME) / INTERVAL) / width) * width * INTERVAL, interval.getEndTime() + 1);
            }

        } catch (TimeRangeException e) {
            fail(e.getMessage());
        } catch (StateSystemDisposedException e) {
            fail(e.getMessage());
        } catch (AttributeNotFoundException e) {
            fail(e.getMessage());
        } catch (StateValueTypeException e) {
            fail(e.getMessage());
        }
        assertTrue(true);
    }


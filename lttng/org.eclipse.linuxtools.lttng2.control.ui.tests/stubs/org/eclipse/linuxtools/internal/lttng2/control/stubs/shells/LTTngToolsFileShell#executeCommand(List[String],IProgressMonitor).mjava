    @Override
    public synchronized ICommandResult executeCommand(List<String> command, IProgressMonitor monitor) throws ExecutionException {
        Map<String, ICommandResult> commands = fScenarioMap.get(fScenario);
        String commandLine = LTTngControlService.toCommandString(command);
        String fullCommand = commandLine;

        Matcher matcher = LTTNG_LIST_SESSION_PATTERN.matcher(commandLine);
        if (matcher.matches() && !commandLine.matches(LTTNG_LIST_PROVIDER_PATTERN)) {
            String sessionName = matcher.group(1).trim();
            Integer i = fSessionNameMap.get(sessionName);
            if (i != null) {
                i++;
            } else {
                i = 0;
            }
            fSessionNameMap.put(sessionName, i);
            fullCommand += String.valueOf(i);
        }

        if (commands.containsKey(fullCommand)) {
            return commands.get(fullCommand);
        }

        String[] output = new String[1];
        output[0] = String.valueOf("Command not found");
        CommandResult result = new CommandResult(0, null, null);
        // For verification of setters of class CommandResult
        result.setOutput(output);
        result.setErrorOutput(output);
        result.setResult(1);
        return result;
    }


	private StateDataRequest getDataRequestStateSave(TmfTimeRange timeWindow,
			IStateDataRequestListener requestListener) {

		final TmfEvent[] evt = new TmfEvent[1];

		// ***FIXME***
		// The override of handlePartialResult is exactly the same as the one in
		// getDataRequestByPosition()
		// However, there is no way to override it in only one place to avoid
		// code duplication!
		// ***

		// Create the new request and override the handlePartialResult function
		StateDataRequest request = new StateDataRequest(timeWindow,
				DEFAULT_OFFSET, TmfDataRequest.ALL_EVENTS, DEFAULT_CHUNK,
				requestListener, this) {

			@Override
			public void handleData() {
				TmfEvent[] result = getData();

				evt[0] = (result.length > 0) ? result[0] : null;
				// Dispatch information for Event processing
				stateIn.processEvent(evt[0]);

				// Call the function that will save a checkpoint if needed at
				// that point
				// Note : We call this function before eventCount incrementation
				// to avoid skipping the "0th" event
				if (evt[0] != null) {
					saveCheckPointIfNeeded(getNumOfEvents(), evt[0]
							.getTimestamp());
				}

				// increment internal and external counters
				setNumOfEvents(getNumOfEvents() + 1);
				eventCount++;
			}

			public void handleCompleted() {
				requestCompleted();

				// Notify listeners of the completion of this request.
				notifyCompletion();
				TraceDebug.debug("number of events processed on file opening"
						+ getNumOfEvents());
			}
		};

		return request;
	}


    /**
     * @param file
     * @param size
     * @param monotonic
     * @throws FileNotFoundException
     * @throws IOException
     */
    private static void createTestFile(String file, int size, boolean monotonic) throws FileNotFoundException, IOException {
        DataOutputStream out;
        System.out.println("Creating " + file);
        out = new DataOutputStream(new BufferedOutputStream(new FileOutputStream(file)));

        Random generator = new Random(19580427 + size);
        long ts = 0;
        for (int i = 0; i < size; i++) {
            ts += monotonic ? 1 : generator.nextInt(10);
            int sourceIndex = i % NB_SOURCES;
            int typeIndex   = i % NB_TYPES;
            out.writeLong(ts);                      // Timestamp
            out.writeUTF("Source-" + sourceIndex);  // Source
            out.writeUTF("Type-"   + typeIndex);    // Type
            out.writeInt(i + 1);                    // Reference (event #)
            for (int j = 0; j < typeIndex; j++) {
                out.writeUTF("Field-" + sourceIndex + "-" + j);
            }
        }
        out.flush();
        out.close();
    }


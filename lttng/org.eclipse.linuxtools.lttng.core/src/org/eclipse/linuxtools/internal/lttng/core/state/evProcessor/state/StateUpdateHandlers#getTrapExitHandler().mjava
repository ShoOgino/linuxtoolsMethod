	/**
	 * 
	 * @return
	 */
	final ILttngEventProcessor getTrapExitHandler() {
		AbsStateUpdate handler = new AbsStateUpdate() {

			// @Override
			@Override
			public boolean process(LttngEvent trcEvent, LttngTraceState traceSt) {

				Long cpu = trcEvent.getCpuId();
				LTTngCPUState cpust = traceSt.getCpu_states().get(cpu);
				Long trap = cpust.popFromTrapStack();

				/* update process state */
				pop_state(cpu, ExecutionMode.LTTV_STATE_TRAP, traceSt, trcEvent
						.getTimestamp());

				/* update cpu status */
				cpu_pop_mode(cpust);

				if (trap != -1L) {
					traceSt.getTrap_states().get(trap).decrementRunning();
				}
				// else {
				// TraceDebug.debug("remove this line");
				// }

				return false;

			}
		};
		return handler;
	}


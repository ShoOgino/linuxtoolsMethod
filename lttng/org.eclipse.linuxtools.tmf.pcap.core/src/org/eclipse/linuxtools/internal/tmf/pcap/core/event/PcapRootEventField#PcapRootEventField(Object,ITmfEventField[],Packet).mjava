    /**
     * Full constructor
     *
     * @param value
     *            The event field value.
     * @param fields
     *            The list of subfields.
     * @param packet
     *            The packet from which to take the fields from.
     * @throws IllegalArgumentException
     *             If 'name' is null, or if 'fields' has duplicate field names.
     */
    public PcapRootEventField(Object value, @Nullable ITmfEventField[] fields, Packet packet) {
        super(ITmfEventField.ROOT_FIELD_ID, value, fields);
        fPacketSourceField = new TmfEventField(PcapEvent.EVENT_FIELD_PACKET_SOURCE,
                packet.getMostEcapsulatedPacket().getSourceEndpoint().toString(), null);
        fPacketDestinationField = new TmfEventField(PcapEvent.EVENT_FIELD_PACKET_DESTINATION,
                packet.getMostEcapsulatedPacket().getDestinationEndpoint().toString(), null);
        fProtocolField = new TmfEventField(PcapEvent.EVENT_FIELD_PACKET_PROTOCOL,
                packet.getMostEcapsulatedPacket().getProtocol().getShortName().toUpperCase(), null);
        fSummaryString = packet.getGlobalSummaryString();
    }


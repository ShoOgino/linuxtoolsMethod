	/**
	 * Parse the given document and produce an AutoconfElement tree,
	 * and control whether the initial quoting style is m4 style (`...')
	 * or autoconf style ([ ... ]).
	 * @param errorHandler
	 * @param macroValidator
	 * @param document
	 * @param useAutoconfQuotes
	 * @return element tree
	 */
	public AutoconfElement parse(IDocument document, boolean useAutoconfQuotes) {
		this.tokenizer = new AutoconfTokenizer(document, errorHandler);
		if (useAutoconfQuotes)
			tokenizer.setM4Quote("[", "]");
		
		AutoconfElement root = new AutoconfRootElement();
		Token eof = parseTopLevel(root);
		
		root.setStartOffset(0);
		root.setDocument(document);
		
		setSourceEnd(root, eof);
		
		return root;
	}


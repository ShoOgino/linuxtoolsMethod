	public IToken evaluate(ICharacterScanner scanner) {
		int c = scanner.read();
		fBuffer.setLength(0);

		fBuffer.append((char)c);
		if (c == 'A') {
			c = scanner.read();
			fBuffer.append((char)c);
			if (c != 'C' && c != 'H' && c != 'M') {
				unreadBuffer(scanner);
				return Token.UNDEFINED;	
			}
			fDetector = generalMacroWordDetector;
		} else if (c == 'm') {
			c = scanner.read();
			fBuffer.append((char)c);
			if (c != 4) {
				unreadBuffer(scanner);
				return Token.UNDEFINED;
			}
			fDetector = m4MacroWordDetector;
		} else {
			unreadBuffer(scanner);
			return Token.UNDEFINED;
		}
		
    	c = scanner.read();
		while (c != ICharacterScanner.EOF
				&& fDetector.isWordPart((char) c)) {
			fBuffer.append((char) c);
			c = scanner.read();
		}

		if (c != ICharacterScanner.EOF) {
			if (c == ';' || fWsDetector.isWhitespace((char)c)) {
				// We are done
			}
			else if (c == '(') {
				matchParentheses(scanner);
			}
			else {
				scanner.unread();
				unreadBuffer(scanner);
				return Token.UNDEFINED;
			}
		}

		scanner.unread();
		return token;
	}


	public OprofileSession(ILaunchConfiguration config) {
		_counters = OprofileCounter.getCounters(config);

		try {
			_launchConfig = config.getAttribute(LaunchPlugin.ATTR_C_LAUNCH_CONFIG, (String) null);	
		} catch (CoreException ce) {
			_launchConfig = null;	//this wont happen without something ridiculous gone wrong
		}
		
		String imagePath = "all";	//default, but should never go through
		
		try {
			//FIXME: this assumes that project names are always the directory names in the workspace.
			//this assumption may be shaky, but a shallow lookup makes it seem ok

			ILaunchConfiguration claunch = DebugPlugin.getDefault().getLaunchManager().getLaunchConfiguration(_launchConfig);
			String workspacePath = ResourcesPlugin.getWorkspace().getRoot().getLocation().toString();
			imagePath = workspacePath + "/" +
					 	  	   claunch.getAttribute(ICDTLaunchConfigurationConstants.ATTR_PROJECT_NAME,"") + "/" +
					 	  	   claunch.getAttribute(ICDTLaunchConfigurationConstants.ATTR_PROGRAM_NAME,"");
		} catch (CoreException e) { }
		
		_options = new LaunchOptions();
		_options.loadConfiguration(config);
		_options.setImage(imagePath);
	}

